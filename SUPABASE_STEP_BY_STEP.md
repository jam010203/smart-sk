# Supabase setup – step-by-step guide

Follow these steps in order. When done, accounts generated by an admin will sync across all browsers and devices.

---

## Step 1: Create a Supabase account and project

1. Open your browser and go to **https://supabase.com**.
2. Click **Start your project** (or **Sign in** if you already have an account).
3. Sign in with GitHub or your email.
4. Click **New project**.
5. Fill in:
   - **Name**: e.g. `SK` (or any name you like).
   - **Database password**: choose a strong password and **save it somewhere safe** (you need it for DB access later).
   - **Region**: pick the one closest to you.
6. Click **Create new project** and wait until the project is ready (about 1–2 minutes).

---

## Step 2: Get your Project URL and anon key

1. In the Supabase dashboard, click the **Settings** (gear) icon in the left sidebar.
2. Click **API** under “Project settings”.
3. On the API page you’ll see:
   - **Project URL** (e.g. `https://abcdefghijk.supabase.co`)
   - **Project API keys** → **anon** **public** (a long key starting with `eyJ...`)
4. Keep this tab open (or copy both values to a notepad):
   - Copy **Project URL**.
   - Copy the **anon public** key (not the `service_role` key).

---

## Step 3: Create the database table and enable Realtime

1. In the Supabase left sidebar, click **SQL Editor**.
2. Click **New query**.
3. Copy the SQL below and paste it into the editor:

```sql
-- Table for app config (generated accounts synced across all browsers)
create table if not exists public.app_config (
  id text primary key,
  data jsonb not null default '{}'
);

-- Enable Realtime so all browsers get updates when admin generates/edits accounts
alter publication supabase_realtime add table public.app_config;

comment on table public.app_config is 'App config; row id=generatedAccounts stores { accounts: [...], updatedAt }';
```

4. Click **Run** (or press Ctrl+Enter / Cmd+Enter).
5. You should see a success message.  
   - If you see “relation … already in publication” or “table already in publication”, that’s fine — the table and Realtime are already set up.

---

## Step 4: Add environment variables to your project (local)

1. Open your project folder in your editor (the one that contains `package.json` and `src`).
2. In the **root** of the project (same level as `package.json`), create or open the file **`.env`**.
3. Add these two lines, replacing the placeholders with the values from **Step 2**:

```
VITE_SUPABASE_URL=https://YOUR_PROJECT_REF.supabase.co
VITE_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

Example (with fake values):

```
VITE_SUPABASE_URL=https://abcdefghijk.supabase.co
VITE_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFiY2RlZmdoaWprIiwicm9sZSI6ImFub24iLCJpYXQiOjE2...
```

4. Save the file.  
   - Make sure **`.env`** is in your **.gitignore** so you don’t commit secrets.

---

## Step 5: Run the app and test (local)

1. In a terminal, from the project root, run:

```bash
npm run dev
```

2. Open the app in your browser (e.g. the URL Vite shows, often **http://localhost:5173**).
3. Log in as **admin** (your admin email and admin password).
4. Go to **Generate Account** (sidebar).
5. Create a test account (e.g. email part: `testuser`, password: whatever you like).
6. Open **Manage User** — you should see the new account.
7. Open the same app in **another browser** (or another device), or an incognito window:
   - Go to **Manage User** (after logging in as admin) — you should see the **same** account.
   - Or log out and log in with the **generated user** (e.g. `testuser@sklgu.gov.ph` and the password you set) — login should work.

If all of that works, Supabase is set up correctly and accounts sync across browsers.

---

## Step 6 (optional): Deploy to Netlify or Vercel

If you deploy the app:

1. **Netlify**: Site → **Site configuration** → **Environment variables** (or **Build & deploy** → **Environment**). Add both variables, then go to **Deploys** → **Trigger deploy** → **Deploy site** so the next build includes them.
2. **Vercel**: Project → **Settings** → **Environment variables**.

Add the same two variables:

- **Key**: `VITE_SUPABASE_URL`  
  **Value**: your Project URL (e.g. `https://abcdefghijk.supabase.co`)

- **Key**: `VITE_SUPABASE_ANON_KEY`  
  **Value**: your anon public key

3. **Redeploy** the site (e.g. “Trigger deploy” on Netlify or “Redeploy” on Vercel) so the build uses the new variables.

After redeploy, the live site will use Supabase and accounts will sync across all browsers there too.

---

## Quick checklist

- [ ] Step 1: Supabase project created  
- [ ] Step 2: Project URL and anon key copied  
- [ ] Step 3: SQL run in SQL Editor (table + Realtime)  
- [ ] Step 4: `.env` has `VITE_SUPABASE_URL` and `VITE_SUPABASE_ANON_KEY`  
- [ ] Step 5: `npm run dev` → Generate Account → see account in Manage User and in another browser  
- [ ] Step 6 (optional): Env vars added on Netlify/Vercel and site redeployed  

If something doesn’t work, double-check that the **anon public** key (not service_role) and the **Project URL** are correct and that there are no extra spaces in `.env`.
